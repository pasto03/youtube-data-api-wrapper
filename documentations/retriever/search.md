> **Note**: This documentation was generated by AI and may contain inaccuracies. Please verify information and refer to the source code for authoritative details.

# SearchRetriever

## Purpose

The `SearchRetriever` searches YouTube for channels, videos, or playlists based on search queries and optional filters. It supports pagination to retrieve multiple pages of results.

## Input Requirements

- **Input Type**: `list[SearchParamProps]` — List of search parameter objects
- **SearchParamProps Fields**:
  - `q` (str, required): Search query string
  - `channelId` (str, optional): Limit search to specific channel
  - `videoCategoryId` (str, optional): Filter by video category
  - `videoDuration` (str, optional): Filter by duration ("any", "short", "medium", "long")
  - `order` (str, optional): Sort order ("date", "rating", "viewCount", "relevance", "title", "videoCount")
  - `publishedAfter` (str, optional): Filter by publish date (RFC 3339 format)

## Output Structure

Returns a list of dictionaries, each containing:

- **Core Fields**: `kind`, `etag`
- **ID Object**: Contains `kind` and resource-specific ID:
  - `id.kind` — Resource type ("youtube#video", "youtube#channel", "youtube#playlist")
  - `id.videoId` — Video ID (if kind is "youtube#video")
  - `id.channelId` — Channel ID (if kind is "youtube#channel")
  - `id.playlistId` — Playlist ID (if kind is "youtube#playlist")
- **Snippet**: Title, description, published date, thumbnails, channel information

### Key Fields

- `id.kind` — Type of result ("youtube#video", "youtube#channel", "youtube#playlist")
- `id.videoId` / `id.channelId` / `id.playlistId` — Resource ID
- `snippet.title` — Title of the result
- `snippet.description` — Description
- `snippet.publishedAt` — Publish date
- `snippet.thumbnails` — Thumbnail images
- `snippet.channelTitle` — Channel name (for videos/playlists)

## Common Use Cases

1. **Content Discovery** — Find videos, channels, or playlists by keywords
2. **Channel Analysis** — Search for videos from specific channels
3. **Trending Content** — Search with sorting by view count or date
4. **Filtered Searches** — Apply filters for duration, category, date range
5. **Multi-Type Search** — Search for multiple resource types simultaneously

## Example Usage

### Basic Video Search

```python
from yt_pipeline.retriever import SearchRetriever, SearchParamProps, SearchTypeCheckboxProps, PipeSettings

search_params = [
    SearchParamProps(q="python tutorial", order="relevance")
]

retriever = SearchRetriever(
    iterable=search_params,
    developerKey=devKey,
    types=SearchTypeCheckboxProps(video=True),
    settings=PipeSettings(max_page=1)
)

results = retriever.invoke()

# Extract video IDs
video_ids = []
for item in results:
    if item['id']['kind'] == 'youtube#video':
        video_ids.append(item['id']['videoId'])
```

### Search Multiple Types

```python
retriever = SearchRetriever(
    iterable=[SearchParamProps(q="music")],
    developerKey=devKey,
    types=SearchTypeCheckboxProps(channel=True, playlist=True, video=True),
    settings=PipeSettings(max_page=2)
)

results = retriever.invoke()

# Separate by type
videos = [item for item in results if item['id']['kind'] == 'youtube#video']
channels = [item for item in results if item['id']['kind'] == 'youtube#channel']
playlists = [item for item in results if item['id']['kind'] == 'youtube#playlist']
```

### Filtered Search

```python
search_params = [
    SearchParamProps(
        q="tutorial",
        videoDuration="medium",  # 4-20 minutes
        order="viewCount",        # Sort by views
        publishedAfter="2024-01-01T00:00:00Z"
    )
]

retriever = SearchRetriever(
    iterable=search_params,
    developerKey=devKey,
    types=SearchTypeCheckboxProps(video=True),
    settings=PipeSettings(max_page=3)
)

results = retriever.invoke(multithread=True)
```

### Search Within Channel

```python
search_params = [
    SearchParamProps(
        q="",  # Empty query to get all videos
        channelId="UC_x5XG1OV2P6uZZ5FSM9Ttw",
        order="date"  # Sort by upload date
    )
]

retriever = SearchRetriever(
    iterable=search_params,
    developerKey=devKey,
    types=SearchTypeCheckboxProps(video=True),
    settings=PipeSettings(retrieval="all", max_page=10)
)

results = retriever.invoke()
```

## Special Considerations

1. **Pagination** — Use `PipeSettings` to control number of pages retrieved
2. **Mixed Results** — Even with type filters, results may include unexpected types (YouTube API quirk)
3. **Quota Cost** — 100 units per API call (search is expensive)
4. **Result Limits** — Maximum 50 results per page
5. **Sorting** — Different sort orders available: "date", "rating", "viewCount", "relevance", "title", "videoCount"

## Related Components

- **[SearchForeman](../foreman/search.md)** — Structured search result access
- **[SearchContainer](../container/search.md)** — Parsed search result objects
- **[SearchShipper](../shipper/search.md)** — Flattened search result data

## Next Steps

- Read about [Retriever Use Cases](./use-cases.md) for more examples
- Learn about [SearchForeman](../foreman/search.md) for structured access
- Explore [Pipelines](../pipeline/pipeline.md) for automated workflows
