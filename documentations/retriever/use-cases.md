> **Note**: This documentation was generated by AI and may contain inaccuracies. Please verify information and refer to the source code for authoritative details.

# Retriever Use Cases

This document provides practical examples of when and how to use each retriever component.

## Quick Reference

| Retriever                | Use Case                   | Input                    | Output          |
| ------------------------ | -------------------------- | ------------------------ | --------------- |
| ChannelsRetriever        | Get channel details        | List of channel IDs      | Channel details |
| VideosRetriever          | Get video details          | List of video IDs        | Video details   |
| PlaylistsRetriever       | Get playlists from channel | List of channel IDs      | Playlists       |
| PlaylistItemsRetriever   | Get items from playlist    | List of playlist IDs     | Playlist items  |
| SearchRetriever          | Search YouTube             | List of SearchParamProps | Search results  |
| CommentThreadsRetriever  | Get comments from video    | List of video IDs        | Comment threads |
| CaptionsRetriever        | Get captions for video     | CaptionsParams           | Caption data    |
| VideoCategoriesRetriever | Get video categories       | Region code              | Category list   |

## Common Patterns

### Pattern 1: Batch Retrieval

Retrieve details for multiple items at once:

```python
from yt_pipeline.retriever import ChannelsRetriever, RetrieverSettings

channel_ids = ["UC_x5XG1OV2P6uZZ5FSM9Ttw", "UCuAXFkgsw1L7xaCfnd5JJOw"]
retriever = ChannelsRetriever(
    iterable=channel_ids,
    developerKey=devKey,
    max_workers=8
)

results = retriever.invoke(
    multithread=True,
    backup=True
)
```

### Pattern 2: Paginated Retrieval

Retrieve all pages of results:

```python
from yt_pipeline.retriever import PlaylistsRetriever, PipeSettings, RetrieverSettings

retriever = PlaylistsRetriever(
    iterable=["UC_x5XG1OV2P6uZZ5FSM9Ttw"],
    developerKey=devKey,
    settings=PipeSettings(retrieval="all", max_page=10)  # Get up to 10 pages
)

results = retriever.invoke(multithread=True)
```

### Pattern 3: Limited Retrieval

Get only the first N items:

```python
from yt_pipeline.retriever import PlaylistsRetriever, PipeSettings

retriever = PlaylistsRetriever(
    iterable=["UC_x5XG1OV2P6uZZ5FSM9Ttw"],
    developerKey=devKey,
    settings=PipeSettings(retrieval="custom", n=5)  # Get only 5 items
)

results = retriever.invoke()
```

## Detailed Examples

### Example 1: Get Channel Statistics

```python
from yt_pipeline.retriever import ChannelsRetriever

channel_ids = ["UC_x5XG1OV2P6uZZ5FSM9Ttw"]
retriever = ChannelsRetriever(
    iterable=channel_ids,
    developerKey=devKey
)

results = retriever.invoke()

# Access raw API response
for channel in results:
    print(channel['snippet']['title'])
    print(channel['statistics']['viewCount'])
    print(channel['statistics']['subscriberCount'])
```

### Example 2: Search for Videos

```python
from yt_pipeline.retriever import SearchRetriever, SearchParamProps, SearchTypeCheckboxProps, PipeSettings

search_params = [
    SearchParamProps(q="python tutorial", order="relevance")
]

retriever = SearchRetriever(
    iterable=search_params,
    developerKey=devKey,
    types=SearchTypeCheckboxProps(video=True),
    settings=PipeSettings(max_page=3)  # Get 3 pages of results
)

results = retriever.invoke(multithread=True)

# Extract video IDs
video_ids = []
for item in results:
    if item['id']['kind'] == 'youtube#video':
        video_ids.append(item['id']['videoId'])
```

### Example 3: Get All Playlists from Channel

```python
from yt_pipeline.retriever import PlaylistsRetriever, PipeSettings

retriever = PlaylistsRetriever(
    iterable=["UC_x5XG1OV2P6uZZ5FSM9Ttw"],
    developerKey=devKey,
    settings=PipeSettings(retrieval="all", max_page=50)  # Get all playlists
)

results = retriever.invoke(multithread=True)

playlist_ids = [item['id'] for item in results]
```

### Example 4: Get Comments from Multiple Videos

```python
from yt_pipeline.retriever import CommentThreadsRetriever, PipeSettings

video_ids = ["dQw4w9WgXcQ", "jNQXAC9IVRw"]
retriever = CommentThreadsRetriever(
    iterable=video_ids,
    developerKey=devKey,
    settings=PipeSettings(max_page=2)  # Get 2 pages of comments per video
)

results = retriever.invoke(multithread=True)
```

### Example 5: Error Handling

```python
from yt_pipeline.retriever import ChannelsRetriever

channel_ids = ["valid_id", "invalid_id", "another_valid_id"]
retriever = ChannelsRetriever(
    iterable=channel_ids,
    developerKey=devKey
)

results = retriever.invoke()

# Check for errors
if isinstance(results, tuple):
    data, error = results
    print(f"Error occurred: {error}")
    # Process successful results
    for channel in data:
        print(channel['snippet']['title'])
else:
    # All successful
    for channel in results:
        print(channel['snippet']['title'])
```

## Best Practices

1. **Use Multithreading for Batch Operations** — Enable `multithread=True` when processing multiple items
2. **Set Appropriate max_page** — Limit pagination to avoid excessive API calls
3. **Enable Backup** — Use `backup=True` to prevent data loss
4. **Handle Errors** — Check for tuple returns which indicate errors
5. **Use Foremen for Structured Data** — Consider using Foremen if you need structured, type-safe access

## When to Use Retrievers vs Foremen

### Use Retrievers When:

- You need raw API responses
- You're building custom processing logic
- You need fine-grained control
- You're integrating with other systems

### Use Foremen When:

- You want structured, type-safe data
- You need a simpler interface
- You're building pipelines
- You want automatic data parsing

## Next Steps

- Explore specific retrievers: [Channels](./channels.md), [Videos](./videos.md), [Search](./search.md)
- Learn about [Foremen](../foreman/foreman.md) for structured data access
- Read about [Pipelines](../pipeline/pipeline.md) for automated workflows
