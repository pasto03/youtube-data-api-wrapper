> **Note**: This documentation was generated by AI and may contain inaccuracies. Please verify information and refer to the source code for authoritative details.

# Pipeline Constructor

## Overview

The **Pipeline Constructor** provides string notation for building pipelines quickly and intuitively. It's ideal for rapid prototyping and simplifies pipeline creation.

## Purpose

String notation enables:

- **Rapid Prototyping** — Build pipelines quickly
- **Readable Syntax** — Intuitive and easy to understand
- **Less Boilerplate** — No need to create many objects
- **Quick Iteration** — Easily modify pipeline structure

## Syntax

### Basic Syntax

```
<foreman_name> -> <foreman_name> -> ...
```

### Search Syntax

```
search(<types>) -> <foreman_name> -> ...
```

Types: `channel`, `playlist`, `video` (comma-separated)

### Modifiers

```
<foreman_name><modifier> -> ...
```

Modifiers:

- `save_output` — Save this block's output
- `max_workers(n)` — Set number of workers
- `max_page(n)` — Set maximum pages (for iterable foremen)

## Examples

### Simple Pipeline

```python
from yt_pipeline.pipeline import PipelineBlocksConstructor, PipelineStacks, Pipeline
from yt_pipeline.retriever import RetrieverSettings, PipeSettings, SearchParamProps

constructor = PipelineBlocksConstructor(
    retriever_settings=RetrieverSettings(multithread=True),
    pipe_settings=PipeSettings(max_page=1)
)

pipeline_blocks = constructor.construct(
    "search(video) -> videos -> comments"
)

stacks = PipelineStacks(
    initial_input=[SearchParamProps(q="python")],
    blocks=pipeline_blocks
)

pipeline = Pipeline(stacks=stacks, developerKey=devKey)
```

### With Modifiers

```python
pipeline_blocks = constructor.construct(
    "search(video)<save_output max_page(1)> -> videos<save_output max_workers(16)> -> comments<save_output max_page(2)>"
)
```

### Multiple Search Types

```python
pipeline_blocks = constructor.construct(
    "search(channel,playlist,video)<save_output> -> channels<save_output> -> playlists<save_output>"
)
```

### Complex Pipeline

```python
pipeline_blocks = constructor.construct(
    "search(channel)<save_output max_page(1)> -> channels<save_output> -> playlists<save_output max_page(5)> -> playlist_items<save_output> -> videos<save_output max_workers(16)>"
)
```

## Branched Pipeline Syntax

For branched pipelines, use `PipelineBlockNodeConstructor`:

```python
from yt_pipeline.pipeline.tree import PipelineBlockNodeConstructor, BranchedPipelineStacks, BranchedPipeline
from yt_pipeline.retriever import RetrieverSettings, SearchParamProps

constructor = PipelineBlockNodeConstructor(
    retriever_settings=RetrieverSettings(multithread=True)
)

# Create head
head = constructor.construct("search(channel,playlist,video)<save_output max_page(1)>")

# Connect branches
head.connect("channels<save_output>").connect("playlists<save_output>")
head.connect("playlists<save_output>").connect("playlist_items<save_output>")
head.connect("videos<save_output>").connect("comments<save_output>")

stacks = BranchedPipelineStacks(
    initial_input=[SearchParamProps(q="music")],
    head=head
)

pipeline = BranchedPipeline(stacks=stacks, developerKey=devKey)
```

## Modifier Details

### save_output

Saves the block's output to pipeline deliverables:

```
videos<save_output>
```

### max_workers(n)

Sets the number of concurrent threads:

```
videos<max_workers(16)>
```

### max_page(n)

Sets maximum pages for iterable foremen:

```
playlists<max_page(5)>
comments<max_page(2)>
```

### Combined Modifiers

Multiple modifiers separated by spaces:

```
videos<save_output max_workers(16)>
playlists<save_output max_page(5) max_workers(8)>
```

## Default Settings

Constructor accepts default settings:

```python
constructor = PipelineBlocksConstructor(
    retriever_settings=RetrieverSettings(multithread=True),
    pipe_settings=PipeSettings(max_page=1)
)
```

These apply to all blocks unless overridden by modifiers.

## Best Practices

1. **Use for Prototyping** — String notation is great for quick iteration
2. **Switch to Objects for Production** — Object notation is more explicit and maintainable
3. **Use Modifiers Sparingly** — Only when needed, rely on defaults otherwise
4. **Test Incrementally** — Build pipelines step by step
5. **Document Complex Pipelines** — Add comments for complex structures

## Limitations

- Less explicit than object notation
- Harder to debug than object notation
- Limited customization compared to object notation

## When to Use

### Use String Notation When:

- Rapidly prototyping pipelines
- Building simple, straightforward pipelines
- Learning the pipeline system
- Quick testing and iteration

### Use Object Notation When:

- Building production pipelines
- Need fine-grained control
- Want explicit, maintainable code
- Building complex, customized pipelines

## Related Documentation

- **[Linear Pipeline](./linear-pipeline.md)** — Pipeline execution
- **[Branched Pipeline](./branched-pipeline.md)** — Tree-based pipelines
- **[Use Cases](./use-cases.md)** — Practical examples

## Next Steps

- Learn about [Linear Pipelines](./linear-pipeline.md) for execution
- Read about [Pipeline Use Cases](./use-cases.md) for examples
